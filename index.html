<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Scanner Pro - مراقب الشبكات المحترف</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://img.icons8.com/?size=160&id=oOrqjtiYHzFl&format=png" rel="icon">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css" />
    <style>
        :root {
            --primary-color: #00ffff;
            --secondary-color: #ff00ff;
            --success-color: #00ff88;
            --warning-color: #ffaa00;
            --danger-color: #ff4444;
            --dark-bg: #0c0c0c;
            --darker-bg: #080808;
            --light-bg: #1a1a2e;
            --card-bg: rgba(255, 255, 255, 0.05);
            --text-color: #ffffff;
            --text-muted: rgba(255, 255, 255, 0.7);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--light-bg) 100%);
            color: var(--text-color);
            min-height: 100vh;
            direction: rtl;
            overflow-x: hidden;
        }

        /* Navbar */
        .navbar {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(0, 255, 255, 0.3);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        .logo img {
            width: 40px;
            height: 40px;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-color);
            text-decoration: none;
            transition: all 0.3s ease;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            position: relative;
            font-weight: 500;
        }

        .nav-links a:hover {
            color: var(--primary-color);
            background: rgba(0, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .nav-links a.active {
            color: var(--primary-color);
            background: rgba(0, 255, 255, 0.1);
            border-bottom: 2px solid var(--primary-color);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 0;
            height: 2px;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        .nav-links a:hover::after {
            width: 100%;
            left: 0;
            right: auto;
        }

        /* Main Content */
        .main-content {
            margin-top: 80px;
            padding: 2rem;
            max-width: 1800px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Hero Section */
        .hero-section {
            text-align: center;
            padding: 4rem 0;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1) 0%, rgba(255, 0, 255, 0.1) 100%);
            border-radius: 20px;
            margin-bottom: 3rem;
            border: 1px solid rgba(0, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0, 255, 255, 0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .hero-title {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 1;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }

        .hero-subtitle {
            font-size: 1.5rem;
            opacity: 0.9;
            margin-bottom: 2rem;
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        /* Control Panel */
        .control-panel {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(0, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .panel-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .scan-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-weight: 600;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary-color), #0099ff);
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 255, 255, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, var(--secondary-color), #ff6699);
            color: #fff;
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 0, 255, 0.4);
        }

        .btn-success {
            background: linear-gradient(45deg, var(--success-color), #00cc66);
            color: #000;
        }

        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 255, 136, 0.4);
        }

        .btn-warning {
            background: linear-gradient(45deg, var(--warning-color), #ff8800);
            color: #000;
        }

        .btn-warning:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 170, 0, 0.4);
        }

        .btn-danger {
            background: linear-gradient(45deg, var(--danger-color), #cc0000);
            color: #fff;
        }

        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 68, 68, 0.4);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background: rgba(0, 255, 255, 0.1);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        .btn-lg {
            padding: 16px 32px;
            font-size: 1.1rem;
        }

        /* Two Column Layout */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 450px;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .networks-column {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid rgba(0, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .details-column {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid rgba(255, 0, 255, 0.2);
            max-height: 800px;
            overflow-y: auto;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        /* Statistics Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            border: 1px solid rgba(0, 255, 255, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            backdrop-filter: blur(5px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .stat-card:hover {
            transform: translateY(-5px) scale(1.02);
            border-color: rgba(0, 255, 255, 0.5);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }

        .stat-number {
            font-size: 2.2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--text-color);
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.8;
        }

        /* Networks Table */
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            text-align: center;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 25%;
            width: 50%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary-color), transparent);
        }

        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            max-height: 500px;
            overflow-y: auto;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(0, 0, 0, 0.3);
        }

        th, td {
            padding: 1rem;
            text-align: right;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.95rem;
        }

        th {
            background: linear-gradient(45deg, var(--primary-color), #0099ff);
            color: #000;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .network-row {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .network-row:hover {
            background: rgba(0, 255, 255, 0.1);
            transform: scale(1.01);
        }

        .network-row.selected {
            background: rgba(0, 255, 255, 0.2);
            border-left: 4px solid var(--primary-color);
        }

        .signal-strength {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .signal-bars {
            display: flex;
            gap: 2px;
        }

        .bar {
            width: 4px;
            height: 16px;
            background: #333;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .bar.active {
            background: linear-gradient(to top, #ff0000, #ffff00, #00ff00);
            box-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
        }

        .security-badge, .network-type {
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            display: inline-block;
            min-width: 60px;
            text-align: center;
        }

        .wpa3 { background: var(--success-color); color: #000; }
        .wpa2 { background: var(--warning-color); color: #000; }
        .wep { background: #ff6600; color: #fff; }
        .open { background: var(--danger-color); color: #fff; }

        .wifi { background: #0099ff; color: #fff; }
        .mobile-5g { background: var(--secondary-color); color: #fff; }
        .mobile-4g { background: #9900ff; color: #fff; }
        .mobile-3g { background: #ff6600; color: #fff; }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-left: 0.5rem;
            box-shadow: 0 0 5px currentColor;
        }

        .hidden { background: var(--warning-color); }
        .visible { background: var(--success-color); }

        /* Network Details Panel */
        .network-details {
            display: none;
        }

        .network-details.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .detail-header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: linear-gradient(45deg, rgba(0, 255, 255, 0.1), rgba(255, 0, 255, 0.1));
            border-radius: 10px;
            border: 1px solid rgba(0, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .detail-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0, 255, 255, 0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
            z-index: -1;
        }

        .detail-ssid {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
        }

        .detail-type {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .detail-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .detail-section h3 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.3rem;
            border-bottom: 1px solid rgba(0, 255, 255, 0.2);
            padding-bottom: 0.5rem;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            opacity: 0.9;
            font-size: 1rem;
        }

        .detail-value {
            font-weight: bold;
            color: var(--primary-color);
            font-size: 1rem;
            text-align: left;
            direction: ltr;
        }

        /* Charts */
        .chart-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            height: 250px;
            border: 1px solid rgba(0, 255, 255, 0.2);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .chart-title {
            color: var(--primary-color);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Advanced Tools */
        .tools-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 1.2rem;
            margin: 1.5rem 0;
        }

        .tool-btn {
            padding: 1rem;
            background: linear-gradient(45deg, rgba(0, 255, 255, 0.1), rgba(255, 0, 255, 0.1));
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.95rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .tool-btn:hover {
            background: linear-gradient(45deg, rgba(0, 255, 255, 0.2), rgba(255, 0, 255, 0.2));
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .tool-btn i {
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        /* Security Analysis */
        .security-score {
            text-align: center;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1.5rem 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .security-score::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: inherit;
            filter: brightness(1.2);
            z-index: -1;
            opacity: 0.7;
        }

        .score-excellent { background: linear-gradient(45deg, var(--success-color), #00cc66); }
        .score-good { background: linear-gradient(45deg, var(--warning-color), #cccc00); }
        .score-poor { background: linear-gradient(45deg, #ff6600, #cc4400); }
        .score-critical { background: linear-gradient(45deg, var(--danger-color), #cc0000); }

        .score-number {
            font-size: 3.5rem;
            font-weight: bold;
            color: #000;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }

        .score-label {
            font-size: 1.2rem;
            color: #000;
            font-weight: bold;
            margin-top: 0.5rem;
        }

        /* Real-time Monitoring */
        .monitoring-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .monitor-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(0, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .monitor-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .monitor-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .monitor-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Map Container */
        .map-container {
            height: 300px;
            border-radius: 10px;
            overflow: hidden;
            margin: 1.5rem 0;
            border: 1px solid rgba(0, 255, 255, 0.3);
        }

        /* Footer */
        .footer {
            background: rgba(0, 0, 0, 0.9);
            padding: 4rem 0 2rem;
            margin-top: 4rem;
            border-top: 1px solid rgba(0, 255, 255, 0.3);
            position: relative;
        }

        .footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path fill="rgba(0,255,255,0.03)" d="M0,0 L100,0 L100,100 L0,100 Z" /></svg>');
            background-size: cover;
            z-index: -1;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            text-align: center;
        }

        .footer-logo {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2.5rem;
            margin-bottom: 2.5rem;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: var(--text-color);
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            position: relative;
        }

        .footer-links a:hover {
            color: var(--primary-color);
        }

        .footer-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            right: 0;
            width: 0;
            height: 2px;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        .footer-links a:hover::after {
            width: 100%;
            left: 0;
            right: auto;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }

        .social-link {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-color);
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .social-link:hover {
            background: var(--primary-color);
            color: #000;
            transform: translateY(-3px);
        }

        .copyright {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 1.5rem;
            opacity: 0.8;
            font-size: 0.9rem;
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 3rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin: 1.5rem 0;
            border: 1px solid rgba(0, 255, 255, 0.3);
        }

        .spinner {
            border: 5px solid rgba(0, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 5px solid var(--primary-color);
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 1.5rem;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0;
            transition: width 0.3s ease;
        }

        /* Notifications */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            border-left: 5px solid var(--primary-color);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 10000;
            max-width: 350px;
            backdrop-filter: blur(10px);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }

        .notification-close {
            position: absolute;
            top: 5px;
            left: 5px;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1rem;
        }

        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: rgba(0, 0, 0, 0.9);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 0.5rem;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 255, 0.3);
        }

        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: rgba(0, 0, 0, 0.9) transparent transparent transparent;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* Responsive Design */
        @media (max-width: 1400px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .details-column {
                max-height: none;
            }
        }

        @media (max-width: 992px) {
            .hero-title {
                font-size: 2.8rem;
            }
            
            .hero-subtitle {
                font-size: 1.3rem;
            }
            
            .scan-controls {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tools-section {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 1.5rem;
            }

            .nav-links {
                flex-direction: column;
                gap: 1rem;
                width: 100%;
            }

            .nav-links a {
                width: 100%;
                text-align: center;
            }

            .hero-title {
                font-size: 2.2rem;
            }

            .hero-subtitle {
                font-size: 1.1rem;
            }
            
            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .scan-controls {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tools-section {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .footer-links {
                flex-direction: column;
                gap: 1rem;
            }
        }

        @media (max-width: 576px) {
            .main-content {
                padding: 1rem;
            }
            
            .hero-section {
                padding: 2rem 1rem;
            }
            
            .hero-title {
                font-size: 1.8rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .tools-section {
                grid-template-columns: 1fr;
            }
            
            .detail-section {
                padding: 1rem;
            }
            
            .detail-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.3rem;
            }
            
            .detail-value {
                text-align: right;
                width: 100%;
            }
        }

        /* Pulse animation for active elements */
        .pulse {
            animation: pulse 2s infinite;
            box-shadow: 0 0 15px currentColor;
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 5px currentColor; }
            50% { transform: scale(1.02); box-shadow: 0 0 20px currentColor; }
            100% { transform: scale(1); box-shadow: 0 0 5px currentColor; }
        }

        /* Floating elements */
        .float {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }

        /* Background particles */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background: rgba(0, 255, 255, 0.5);
            border-radius: 50%;
            animation: particle-anim linear infinite;
        }

        @keyframes particle-anim {
            0% { transform: translateY(0) translateX(0); opacity: 1; }
            100% { transform: translateY(-1000px) translateX(200px); opacity: 0; }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 255, 255, 0.5);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid rgba(0, 255, 255, 0.3);
            margin-bottom: 1.5rem;
        }

        .tab {
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .tab:hover {
            color: var(--primary-color);
        }

        .tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: rgba(0, 255, 255, 0.1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Accordion */
        .accordion {
            margin: 1rem 0;
        }

        .accordion-item {
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            overflow: hidden;
        }

        .accordion-header {
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .accordion-header:hover {
            background: rgba(0, 255, 255, 0.1);
        }

        .accordion-content {
            padding: 0 1rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .accordion-item.active .accordion-content {
            padding: 1rem;
            max-height: 1000px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            backdrop-filter: blur(10px);
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.show {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: var(--dark-bg);
            border-radius: 15px;
            padding: 2rem;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(0, 255, 255, 0.3);
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            position: relative;
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid rgba(0, 255, 255, 0.3);
            padding-bottom: 1rem;
        }

        .modal-title {
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            color: var(--primary-color);
            transform: rotate(90deg);
        }

        .modal-body {
            margin-bottom: 1.5rem;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            border-top: 1px solid rgba(0, 255, 255, 0.3);
            padding-top: 1.5rem;
        }

        /* Context Menu */
        .context-menu {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            min-width: 200px;
            backdrop-filter: blur(10px);
            display: none;
        }

        .context-menu-item {
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .context-menu-item:hover {
            background: rgba(0, 255, 255, 0.1);
            color: var(--primary-color);
        }

        .context-menu-item i {
            width: 20px;
            text-align: center;
        }

        .context-menu-divider {
            height: 1px;
            background: rgba(0, 255, 255, 0.2);
            margin: 0.3rem 0;
        }
    </style>
</head>
<body>
    <!-- Background Particles -->
    <div class="particles" id="particles"></div>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <img src="https://img.icons8.com/?size=160&id=oOrqjtiYHzFl&format=png" alt="Network Scanner Pro Icon">
                Network Scanner Pro
            </div>
            <ul class="nav-links">
                <li><a href="#home" class="active"><i class="fas fa-home"></i> الرئيسية</a></li>
                <li><a href="#scan"><i class="fas fa-search"></i> المسح</a></li>
                <li><a href="#analytics"><i class="fas fa-chart-bar"></i> التحليلات</a></li>
                <li><a href="#monitoring"><i class="fas fa-eye"></i> المراقبة</a></li>
                <li><a href="#tools"><i class="fas fa-tools"></i> الأدوات</a></li>
                <li><a href="#settings"><i class="fas fa-cog"></i> الإعدادات</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Hero Section -->
        <section class="hero-section" id="home">
            <h1 class="hero-title float">مراقب الشبكات المحترف</h1>
            <p class="hero-subtitle">اكتشف وحلل الشبكات اللاسلكية المجاورة بتقنيات متطورة وأدوات تحليل شاملة مع واجهة مستخدم حديثة وسهلة الاستخدام</p>
            
            <div class="hero-buttons">
                <button class="btn btn-primary btn-lg" onclick="startAdvancedScan()">
                    <i class="fas fa-play"></i>
                    بدء المسح الآن
                </button>
                <button class="btn btn-outline btn-lg" onclick="showTutorialModal()">
                    <i class="fas fa-question-circle"></i>
                    كيفية الاستخدام
                </button>
            </div>
        </section>

        <!-- Control Panel -->
        <section class="control-panel" id="scan">
            <div class="panel-header">
                <h2 class="panel-title">
                    <i class="fas fa-sliders-h"></i>
                    لوحة التحكم
                </h2>
                <div class="tooltip">
                    <i class="fas fa-info-circle" style="color: var(--primary-color); cursor: help;"></i>
                    <span class="tooltip-text">استخدم هذه اللوحة للتحكم في عملية مسح الشبكات والمراقبة المباشرة</span>
                </div>
            </div>

            <div class="scan-controls">
                <button class="btn btn-primary" onclick="startAdvancedScan()">
                    <i class="fas fa-radar-alt"></i>
                    مسح متقدم
                </button>
                <button class="btn btn-secondary" onclick="stopScan()">
                    <i class="fas fa-stop"></i>
                    إيقاف المسح
                </button>
                <button class="btn btn-success" onclick="startRealTimeMonitoring()">
                    <i class="fas fa-broadcast-tower"></i>
                    مراقبة مباشرة
                </button>
                <button class="btn btn-warning" onclick="performSecurityAudit()">
                    <i class="fas fa-shield-virus"></i>
                    تدقيق أمني
                </button>
                <button class="btn btn-primary" onclick="refreshNetworks()">
                    <i class="fas fa-sync-alt"></i>
                    تحديث
                </button>
                <button class="btn btn-secondary" onclick="exportAdvancedData()">
                    <i class="fas fa-file-export"></i>
                    تصدير متقدم
                </button>
                <button class="btn btn-danger" onclick="showAdvancedSettings()">
                    <i class="fas fa-cogs"></i>
                    إعدادات متقدمة
                </button>
                <button class="btn btn-success" onclick="showReports()">
                    <i class="fas fa-file-alt"></i>
                    تقارير مخصصة
                </button>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p class="loading-text">جاري البحث المتقدم عن الشبكات...</p>
                <div class="progress-bar">
                    <div class="progress" id="scanProgress"></div>
                </div>
            </div>
        </section>

        <!-- Statistics -->
        <section class="stats-grid" id="analytics">
            <div class="stat-card" onclick="filterNetworks('all')">
                <div class="stat-icon"><i class="fas fa-wifi"></i></div>
                <div class="stat-number" id="totalNetworks">32</div>
                <div class="stat-label">إجمالي الشبكات</div>
            </div>
            <div class="stat-card" onclick="filterNetworks('secure')">
                <div class="stat-icon"><i class="fas fa-shield-alt"></i></div>
                <div class="stat-number" id="secureNetworks">24</div>
                <div class="stat-label">شبكات محمية</div>
            </div>
            <div class="stat-card" onclick="filterNetworks('open')">
                <div class="stat-icon"><i class="fas fa-unlock"></i></div>
                <div class="stat-number" id="openNetworks">8</div>
                <div class="stat-label">شبكات مفتوحة</div>
            </div>
            <div class="stat-card" onclick="filterNetworks('hidden')">
                <div class="stat-icon"><i class="fas fa-eye-slash"></i></div>
                <div class="stat-number" id="hiddenNetworks">5</div>
                <div class="stat-label">شبكات مخفية</div>
            </div>
            <div class="stat-card" onclick="filterNetworks('strong')">
                <div class="stat-icon"><i class="fas fa-signal"></i></div>
                <div class="stat-number" id="strongSignals">18</div>
                <div class="stat-label">إشارة قوية</div>
            </div>
            <div class="stat-card" onclick="filterNetworks('mobile')">
                <div class="stat-icon"><i class="fas fa-mobile-alt"></i></div>
                <div class="stat-number" id="mobileNetworks">12</div>
                <div class="stat-label">شبكات محمولة</div>
            </div>
            <div class="stat-card" onclick="filterNetworks('wpa3')">
                <div class="stat-icon"><i class="fas fa-lock"></i></div>
                <div class="stat-number" id="wpa3Networks">6</div>
                <div class="stat-label">شبكات WPA3</div>
            </div>
            <div class="stat-card" onclick="filterNetworks('enterprise')">
                <div class="stat-icon"><i class="fas fa-building"></i></div>
                <div class="stat-number" id="enterpriseNetworks">4</div>
                <div class="stat-label">شبكات مؤسسية</div>
            </div>
        </section>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Networks Table Column -->
            <div class="networks-column">
                <div class="panel-header">
                    <h2 class="section-title">
                        <i class="fas fa-list"></i>
                        الشبكات المكتشفة
                    </h2>
                    <div class="tabs">
                        <div class="tab active" onclick="switchTab('all-networks')">كل الشبكات</div>
                        <div class="tab" onclick="switchTab('favorites')">المفضلة</div>
                        <div class="tab" onclick="switchTab('history')">السجل</div>
                    </div>
                </div>

                <div class="tab-content active" id="all-networks">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>SSID</th>
                                    <th>نوع</th>
                                    <th>تشفير</th>
                                    <th>إشارة</th>
                                    <th>قناة</th>
                                    <th>متصلين</th>
                                    <th>حالة</th>
                                    <th>نشاط</th>
                                </tr>
                            </thead>
                            <tbody id="networksTable">
                                <!-- Networks will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="tab-content" id="favorites">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>SSID</th>
                                    <th>نوع</th>
                                    <th>تشفير</th>
                                    <th>إشارة</th>
                                    <th>قناة</th>
                                    <th>متصلين</th>
                                    <th>حالة</th>
                                    <th>نشاط</th>
                                </tr>
                            </thead>
                            <tbody id="favoritesTable">
                                <!-- Favorites will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="tab-content" id="history">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>SSID</th>
                                    <th>تاريخ الاكتشاف</th>
                                    <th>المدة</th>
                                    <th>إشارة</th>
                                    <th>متصلين</th>
                                    <th>حالة</th>
                                </tr>
                            </thead>
                            <tbody id="historyTable">
                                <!-- History will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Network Details Column -->
            <div class="details-column">
                <div id="noSelection" class="text-center" style="padding: 4rem 0; opacity: 0.6;">
                    <i class="fas fa-hand-pointer" style="font-size: 4rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                    <h3>اختر شبكة للتحليل</h3>
                    <p>انقر على أي شبكة في القائمة لعرض التفاصيل والأدوات المتقدمة</p>
                </div>

                <div id="networkDetails" class="network-details">
                    <!-- Network details will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Advanced Tools Section -->
        <section class="control-panel" id="tools">
            <div class="panel-header">
                <h2 class="panel-title">
                    <i class="fas fa-tools"></i>
                    الأدوات المتقدمة
                </h2>
                <div class="tooltip">
                    <i class="fas fa-info-circle" style="color: var(--primary-color); cursor: help;"></i>
                    <span class="tooltip-text">أدوات متقدمة لتحليل الشبكات والاختبارات الأمنية</span>
                </div>
            </div>

            <div class="tools-section">
                <button class="tool-btn" onclick="performPingSweep(selectedNetwork?.id)">
                    <i class="fas fa-satellite-dish"></i>
                    Ping Sweep
                    <span class="tooltip-text">فحص نطاق IP لاكتشاف الأجهزة النشطة</span>
                </button>
                <button class="tool-btn" onclick="portScan(selectedNetwork?.id)">
                    <i class="fas fa-search"></i>
                    Port Scan
                    <span class="tooltip-text">فحص المنافذ المفتوحة على الشبكة</span>
                </button>
                <button class="tool-btn" onclick="packetCapture(selectedNetwork?.id)">
                    <i class="fas fa-download"></i>
                    Packet Capture
                    <span class="tooltip-text">التقاط وتحليل حزم البيانات</span>
                </button>
                <button class="tool-btn" onclick="speedTest(selectedNetwork?.id)">
                    <i class="fas fa-tachometer-alt"></i>
                    Speed Test
                    <span class="tooltip-text">قياس سرعة الاتصال بالشبكة</span>
                </button>
                <button class="tool-btn" onclick="geolocate(selectedNetwork?.id)">
                    <i class="fas fa-map-marker-alt"></i>
                    تحديد الموقع
                    <span class="tooltip-text">تحديد الموقع الجغرافي للشبكة</span>
                </button>
                <button class="tool-btn" onclick="vulnerabilityScan(selectedNetwork?.id)">
                    <i class="fas fa-bug"></i>
                    فحص الثغرات
                    <span class="tooltip-text">فحص الشبكة لاكتشاف الثغرات الأمنية</span>
                </button>
                <button class="tool-btn" onclick="wifiAnalyzer()">
                    <i class="fas fa-chart-pie"></i>
                    محلل WiFi
                    <span class="tooltip-text">تحليل ترددات WiFi والقنوات</span>
                </button>
                <button class="tool-btn" onclick="deauthAttackTest()">
                    <i class="fas fa-user-lock"></i>
                    اختبار Deauth
                    <span class="tooltip-text">اختبار مقاومة هجمات قطع الاتصال</span>
                </button>
            </div>
        </section>

        <!-- Monitoring Section -->
        <section class="control-panel" id="monitoring">
            <div class="panel-header">
                <h2 class="panel-title">
                    <i class="fas fa-chart-line"></i>
                    لوحة المراقبة
                </h2>
                <div class="tooltip">
                    <i class="fas fa-info-circle" style="color: var(--primary-color); cursor: help;"></i>
                    <span class="tooltip-text">مراقبة أداء الشبكة في الوقت الحقيقي</span>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fas fa-signal"></i>
                        نشاط الشبكة عبر الزمن
                    </div>
                    <div>
                        <button class="btn btn-sm btn-outline" onclick="changeTimeRange('1h')">1 ساعة</button>
                        <button class="btn btn-sm btn-outline" onclick="changeTimeRange('6h')">6 ساعات</button>
                        <button class="btn btn-sm btn-outline" onclick="changeTimeRange('24h')">24 ساعة</button>
                    </div>
                </div>
                <canvas id="networkActivityChart"></canvas>
            </div>

            <div class="monitoring-grid">
                <div class="monitor-item">
                    <div class="monitor-value" id="totalTraffic">0 GB</div>
                    <div class="monitor-label">إجمالي حركة البيانات</div>
                </div>
                <div class="monitor-item">
                    <div class="monitor-value" id="packetLoss">0%</div>
                    <div class="monitor-label">فقدان الحزم</div>
                </div>
                <div class="monitor-item">
                    <div class="monitor-value" id="connectedDevices">0</div>
                    <div class="monitor-label">أجهزة متصلة</div>
                </div>
                <div class="monitor-item">
                    <div class="monitor-value" id="networkLatency">0ms</div>
                    <div class="monitor-label">زمن الاستجابة</div>
                </div>
                <div class="monitor-item">
                    <div class="monitor-value" id="securityAlerts">0</div>
                    <div class="monitor-label">تنبيهات أمنية</div>
                </div>
                <div class="monitor-item">
                    <div class="monitor-value" id="signalQuality">0%</div>
                    <div class="monitor-label">جودة الإشارة</div>
                </div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="https://img.icons8.com/?size=160&id=oOrqjtiYHzFl&format=png" alt="Network Scanner Pro Icon" style="width: 50px; height: 50px;">
                Network Scanner Pro
            </div>
            <div class="footer-links">
                <a href="#privacy">سياسة الخصوصية</a>
                <a href="#terms">شروط الاستخدام</a>
                <a href="#contact">اتصل بنا</a>
                <a href="#about">حول المشروع</a>
                <a href="#api">واجهة البرمجة</a>
                <a href="#documentation">التوثيق</a>
                <a href="#support">الدعم الفني</a>
                <a href="#blog">المدونة</a>
            </div>
            <div class="social-links">
                <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                <a href="#" class="social-link"><i class="fab fa-github"></i></a>
                <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
                <a href="#" class="social-link"><i class="fab fa-youtube"></i></a>
                <a href="#" class="social-link"><i class="fab fa-discord"></i></a>
            </div>
            <div class="copyright">
                <p>&copy; 2025 - 2026 جميع الحقوق محفوظة للمطور <strong>Muhammed Alaa</strong> | تم التطوير بتقنيات متقدمة</p>
                <p>هذا المشروع مخصص للأغراض التعليمية ومراقبة الشبكات المصرح بها فقط</p>
                <p>الإصدار 2.5.0 | آخر تحديث: 15 أغسطس 2025</p>
            </div>
        </div>
    </footer>

    <!-- Notification -->
    <div class="notification" id="notification">
        <button class="notification-close" onclick="hideNotification()">&times;</button>
        <div class="notification-title" id="notificationTitle">إشعار</div>
        <div class="notification-message" id="notificationMessage">هذه رسالة إشعار</div>
    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">عنوان النافذة</h3>
                <button class="modal-close" onclick="hideModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                محتوى النافذة
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="hideModal()">إلغاء</button>
                <button class="btn btn-primary" id="modalConfirmBtn">تأكيد</button>
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-item" onclick="addToFavorites()">
            <i class="fas fa-star"></i>
            إضافة إلى المفضلة
        </div>
        <div class="context-menu-item" onclick="exportNetworkData()">
            <i class="fas fa-file-export"></i>
            تصدير البيانات
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" onclick="showNetworkHistory()">
            <i class="fas fa-history"></i>
            عرض السجل
        </div>
        <div class="context-menu-item" onclick="compareNetworks()">
            <i class="fas fa-exchange-alt"></i>
            مقارنة الشبكات
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" onclick="hideNetwork()">
            <i class="fas fa-eye-slash"></i>
            إخفاء الشبكة
        </div>
    </div>

    <script>
        // Enhanced network data with more details
        const advancedNetworks = [
            {
                id: 1,
                ssid: "HomeNetwork_5G_Pro",
                type: "wifi",
                security: "wpa3",
                mac: "AA:BB:CC:DD:EE:FF",
                bssid: "AA:BB:CC:DD:EE:FF",
                signal: 95,
                channel: 149,
                frequency: "5.745 GHz",
                bandwidth: "160 MHz",
                clients: 12,
                hidden: false,
                lastActivity: "منذ دقيقة",
                vendor: "TP-Link",
                encryption: "AES-CCMP",
                authentication: "WPA3-SAE",
                dataRate: "1200 Mbps",
                uptime: "15 أيام",
                traffic: "2.4 GB/h",
                securityScore: 95,
                vulnerabilities: [],
                geolocation: { lat: 30.0444, lng: 31.2357 },
                beaconInterval: 100,
                dtimPeriod: 1,
                capabilities: ["WPS", "WMM", "Short-GI", "LDPC"],
                operatingSystem: "OpenWrt 22.03",
                firmwareVersion: "v1.2.3",
                supportedStandards: ["802.11a", "802.11n", "802.11ac", "802.11ax"],
                favorite: true,
                history: [
                    { date: "2025-08-01", signal: 92, clients: 10 },
                    { date: "2025-08-02", signal: 90, clients: 11 },
                    { date: "2025-08-03", signal: 94, clients: 12 }
                ]
            },
            {
                id: 2,
                ssid: "Office_Enterprise",
                type: "wifi", 
                security: "wpa2",
                mac: "11:22:33:44:55:66",
                bssid: "11:22:33:44:55:66",
                signal: 78,
                channel: 6,
                frequency: "2.437 GHz",
                bandwidth: "40 MHz",
                clients: 24,
                hidden: false,
                lastActivity: "منذ 3 دقائق",
                vendor: "Cisco",
                encryption: "AES-CCMP",
                authentication: "WPA2-Enterprise",
                dataRate: "300 Mbps",
                uptime: "45 أيام",
                traffic: "5.8 GB/h",
                securityScore: 85,
                vulnerabilities: ["KRACK"],
                geolocation: { lat: 30.0445, lng: 31.2358 },
                beaconInterval: 100,
                dtimPeriod: 3,
                capabilities: ["WMM", "Short-GI"],
                operatingSystem: "Cisco IOS",
                firmwareVersion: "15.1(4)M",
                supportedStandards: ["802.11b", "802.11g", "802.11n"],
                favorite: false,
                history: [
                    { date: "2025-08-01", signal: 80, clients: 22 },
                    { date: "2025-08-02", signal: 75, clients: 23 },
                    { date: "2025-08-03", signal: 78, clients: 24 }
                ]
            },
            {
                id: 3,
                ssid: "[Hidden Network]",
                type: "wifi",
                security: "wpa2",
                mac: "77:88:99:AA:BB:CC",
                bssid: "77:88:99:AA:BB:CC",
                signal: 65,
                channel: 11,
                frequency: "2.462 GHz",
                bandwidth: "20 MHz",
                clients: 3,
                hidden: true,
                lastActivity: "منذ 5 دقائق",
                vendor: "Netgear",
                encryption: "AES-CCMP",
                authentication: "WPA2-PSK",
                dataRate: "150 Mbps",
                uptime: "8 أيام",
                traffic: "0.8 GB/h",
                securityScore: 75,
                vulnerabilities: ["WPS PIN Attack"],
                geolocation: { lat: 30.0443, lng: 31.2356 },
                beaconInterval: 100,
                dtimPeriod: 2,
                capabilities: ["WPS", "WMM"],
                operatingSystem: "Unknown",
                firmwareVersion: "Unknown",
                supportedStandards: ["802.11g", "802.11n"],
                favorite: false,
                history: [
                    { date: "2025-08-01", signal: 70, clients: 2 },
                    { date: "2025-08-02", signal: 68, clients: 3 },
                    { date: "2025-08-03", signal: 65, clients: 3 }
                ]
            },
            {
                id: 4,
                ssid: "Vodafone_5G_Ultra",
                type: "mobile-5g",
                security: "wpa3",
                mac: "DD:EE:FF:00:11:22",
                bssid: "DD:EE:FF:00:11:22",
                signal: 88,
                channel: 36,
                frequency: "5.180 GHz",
                bandwidth: "80 MHz",
                clients: 25,
                hidden: false,
                lastActivity: "الآن",
                vendor: "Huawei",
                encryption: "AES-GCMP-256",
                authentication: "WPA3-SAE",
                dataRate: "2400 Mbps",
                uptime: "120 أيام",
                traffic: "15.2 GB/h",
                securityScore: 98,
                vulnerabilities: [],
                geolocation: { lat: 30.0446, lng: 31.2359 },
                beaconInterval: 100,
                dtimPeriod: 1,
                capabilities: ["WMM", "Short-GI", "LDPC", "STBC"],
                operatingSystem: "Android 12",
                firmwareVersion: "12.1.0",
                supportedStandards: ["802.11ac", "802.11ax"],
                favorite: true,
                history: [
                    { date: "2025-08-01", signal: 85, clients: 20 },
                    { date: "2025-08-02", signal: 87, clients: 23 },
                    { date: "2025-08-03", signal: 88, clients: 25 }
                ]
            },
            {
                id: 5,
                ssid: "Public_WiFi_Free",
                type: "wifi",
                security: "open",
                mac: "33:44:55:66:77:88",
                bssid: "33:44:55:66:77:88",
                signal: 45,
                channel: 1,
                frequency: "2.412 GHz",
                bandwidth: "20 MHz",
                clients: 2,
                hidden: false,
                lastActivity: "منذ 10 دقائق",
                vendor: "D-Link",
                encryption: "None",
                authentication: "Open",
                dataRate: "54 Mbps",
                uptime: "2 أيام",
                traffic: "0.1 GB/h",
                securityScore: 20,
                vulnerabilities: ["Open Network", "No Encryption", "Man-in-the-Middle"],
                geolocation: { lat: 30.0442, lng: 31.2355 },
                beaconInterval: 100,
                dtimPeriod: 1,
                capabilities: ["WMM"],
                operatingSystem: "DD-WRT",
                firmwareVersion: "v3.0",
                supportedStandards: ["802.11b", "802.11g"],
                favorite: false,
                history: [
                    { date: "2025-08-01", signal: 50, clients: 1 },
                    { date: "2025-08-02", signal: 48, clients: 2 },
                    { date: "2025-08-03", signal: 45, clients: 2 }
                ]
            },
            {
                id: 6,
                ssid: "IoT_Network",
                type: "wifi",
                security: "wpa2",
                mac: "99:AA:BB:CC:DD:EE",
                bssid: "99:AA:BB:CC:DD:EE",
                signal: 72,
                channel: 48,
                frequency: "5.240 GHz",
                bandwidth: "40 MHz",
                clients: 8,
                hidden: false,
                lastActivity: "منذ 7 دقائق",
                vendor: "Xiaomi",
                encryption: "AES-CCMP",
                authentication: "WPA2-PSK",
                dataRate: "300 Mbps",
                uptime: "30 أيام",
                traffic: "1.2 GB/h",
                securityScore: 80,
                vulnerabilities: ["Default Credentials"],
                geolocation: { lat: 30.0441, lng: 31.2354 },
                beaconInterval: 100,
                dtimPeriod: 2,
                capabilities: ["WMM"],
                operatingSystem: "OpenWrt",
                firmwareVersion: "19.07.7",
                supportedStandards: ["802.11n", "802.11ac"],
                favorite: false,
                history: [
                    { date: "2025-08-01", signal: 75, clients: 7 },
                    { date: "2025-08-02", signal: 73, clients: 8 },
                    { date: "2025-08-03", signal: 72, clients: 8 }
                ]
            },
            {
                id: 7,
                ssid: "Guest_WiFi",
                type: "wifi",
                security: "wpa2",
                mac: "FF:EE:DD:CC:BB:AA",
                bssid: "FF:EE:DD:CC:BB:AA",
                signal: 60,
                channel: 11,
                frequency: "2.462 GHz",
                bandwidth: "20 MHz",
                clients: 5,
                hidden: false,
                lastActivity: "منذ 15 دقيقة",
                vendor: "ASUS",
                encryption: "AES-CCMP",
                authentication: "WPA2-PSK",
                dataRate: "150 Mbps",
                uptime: "10 أيام",
                traffic: "0.5 GB/h",
                securityScore: 70,
                vulnerabilities: ["Weak Password"],
                geolocation: { lat: 30.0440, lng: 31.2353 },
                beaconInterval: 100,
                dtimPeriod: 2,
                capabilities: ["WPS", "WMM"],
                operatingSystem: "ASUSWRT",
                firmwareVersion: "3.0.0.4.386",
                supportedStandards: ["802.11n"],
                favorite: false,
                history: [
                    { date: "2025-08-01", signal: 65, clients: 4 },
                    { date: "2025-08-02", signal: 62, clients: 5 },
                    { date: "2025-08-03", signal: 60, clients: 5 }
                ]
            },
            {
                id: 8,
                ssid: "SmartHome",
                type: "wifi",
                security: "wpa3",
                mac: "12:34:56:78:90:AB",
                bssid: "12:34:56:78:90:AB",
                signal: 82,
                channel: 153,
                frequency: "5.765 GHz",
                bandwidth: "80 MHz",
                clients: 15,
                hidden: false,
                lastActivity: "منذ 2 دقيقة",
                vendor: "Google",
                encryption: "AES-GCMP-256",
                authentication: "WPA3-SAE",
                dataRate: "867 Mbps",
                uptime: "60 أيام",
                traffic: "3.5 GB/h",
                securityScore: 92,
                vulnerabilities: [],
                geolocation: { lat: 30.0439, lng: 31.2352 },
                beaconInterval: 100,
                dtimPeriod: 1,
                capabilities: ["WMM", "Short-GI"],
                operatingSystem: "Google Nest",
                firmwareVersion: "1.56.330120",
                supportedStandards: ["802.11ac", "802.11ax"],
                favorite: true,
                history: [
                    { date: "2025-08-01", signal: 80, clients: 12 },
                    { date: "2025-08-02", signal: 81, clients: 14 },
                    { date: "2025-08-03", signal: 82, clients: 15 }
                ]
            }
        ];

        // Application state
        let appState = {
            isScanning: false,
            isMonitoring: false,
            scanInterval: null,
            monitorInterval: null,
            selectedNetwork: null,
            currentFilter: 'all',
            activeTab: 'all-networks',
            signalChart: null,
            clientsChart: null,
            networkActivityChart: null,
            contextMenuNetwork: null,
            favorites: [1, 4, 8],
            history: [],
            monitoringData: {
                totalTraffic: 0,
                packetLoss: 0,
                connectedDevices: 0,
                networkLatency: 0,
                securityAlerts: 0,
                signalQuality: 0,
                activityData: []
            }
        };

        // Initialize the application
        function initApp() {
            renderNetworks();
            renderFavorites();
            renderHistory();
            updateStatistics();
            setupEventListeners();
            createParticles();
            initializeNetworkActivityChart();
            updateMonitoringData();
            
            // Load saved state from localStorage
            loadState();
            
            // Auto-start scanning after 2 seconds
            setTimeout(() => {
                startAdvancedScan();
            }, 2000);
        }

        // Save application state to localStorage
        function saveState() {
            localStorage.setItem('networkScannerState', JSON.stringify({
                favorites: appState.favorites,
                history: appState.history
            }));
        }

        // Load application state from localStorage
        function loadState() {
            const savedState = localStorage.getItem('networkScannerState');
            if (savedState) {
                const state = JSON.parse(savedState);
                appState.favorites = state.favorites || [];
                appState.history = state.history || [];
                renderFavorites();
                renderHistory();
            }
        }

        // Create background particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Random size between 1px and 3px
                const size = Math.random() * 2 + 1;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Random position
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                // Random animation duration between 10s and 20s
                const duration = Math.random() * 10 + 10;
                particle.style.animationDuration = `${duration}s`;
                
                // Random delay
                particle.style.animationDelay = `${Math.random() * 5}s`;
                
                particlesContainer.appendChild(particle);
            }
        }

        // Event listeners setup
        function setupEventListeners() {
            // Smooth scrolling for navigation
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                        
                        // Update active nav link
                        document.querySelectorAll('.nav-links a').forEach(link => {
                            link.classList.remove('active');
                        });
                        this.classList.add('active');
                    }
                });
            });
            
            // Context menu for network rows
            document.addEventListener('contextmenu', function(e) {
                const row = e.target.closest('.network-row');
                if (row) {
                    e.preventDefault();
                    showContextMenu(e, parseInt(row.getAttribute('data-network-id')));
                }
            });
            
            // Hide context menu on click
            document.addEventListener('click', function() {
                hideContextMenu();
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey) {
                    switch(e.key) {
                        case 's':
                            e.preventDefault();
                            startAdvancedScan();
                            break;
                        case 'r':
                            e.preventDefault();
                            refreshNetworks();
                            break;
                        case 'e':
                            e.preventDefault();
                            exportAdvancedData();
                            break;
                        case 'm':
                            e.preventDefault();
                            startRealTimeMonitoring();
                            break;
                        case 'f':
                            e.preventDefault();
                            if (appState.selectedNetwork) {
                                addToFavorites(appState.selectedNetwork.id);
                            }
                            break;
                    }
                }
            });
        }

        // Show context menu
        function showContextMenu(e, networkId) {
            const contextMenu = document.getElementById('contextMenu');
            contextMenu.style.display = 'block';
            contextMenu.style.left = `${e.clientX}px`;
            contextMenu.style.top = `${e.clientY}px`;
            appState.contextMenuNetwork = networkId;
        }

        // Hide context menu
        function hideContextMenu() {
            const contextMenu = document.getElementById('contextMenu');
            contextMenu.style.display = 'none';
            appState.contextMenuNetwork = null;
        }

        // Show notification
        function showNotification(title, message, duration = 3000) {
            const notification = document.getElementById('notification');
            document.getElementById('notificationTitle').textContent = title;
            document.getElementById('notificationMessage').textContent = message;
            
            notification.classList.add('show');
            
            if (duration > 0) {
                setTimeout(() => {
                    notification.classList.remove('show');
                }, duration);
            }
        }

        // Hide notification
        function hideNotification() {
            document.getElementById('notification').classList.remove('show');
        }

        // Show modal
        function showModal(title, body, confirmText = 'تأكيد', confirmCallback = null) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').innerHTML = body;
            document.getElementById('modalConfirmBtn').textContent = confirmText;
            
            if (confirmCallback) {
                document.getElementById('modalConfirmBtn').onclick = function() {
                    confirmCallback();
                    hideModal();
                };
            } else {
                document.getElementById('modalConfirmBtn').onclick = hideModal;
            }
            
            document.getElementById('modal').classList.add('show');
        }

        // Hide modal
        function hideModal() {
            document.getElementById('modal').classList.remove('show');
        }

        // Show tutorial modal
        function showTutorialModal() {
            const tutorialContent = `
                <div class="accordion">
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <span>كيفية بدء المسح</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="accordion-content">
                            <p>1. انقر على زر "مسح متقدم" لبدء اكتشاف الشبكات</p>
                            <p>2. انتظر حتى يكتمل المسح (عادة ما يستغرق بضع ثوانٍ)</p>
                            <p>3. اختر شبكة من القائمة لعرض التفاصيل</p>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <span>تحليل الشبكات</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="accordion-content">
                            <p>1. انقر على أي شبكة لعرض تفاصيلها</p>
                            <p>2. تحقق من درجة الأمان والثغرات المحتملة</p>
                            <p>3. استخدم الأدوات المتقدمة لتحليل إضافي</p>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <span>الأدوات المتقدمة</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="accordion-content">
                            <p>1. Ping Sweep: اكتشاف الأجهزة النشطة على الشبكة</p>
                            <p>2. Port Scan: فحص المنافذ المفتوحة</p>
                            <p>3. Packet Capture: التقاط حزم البيانات</p>
                            <p>4. Speed Test: قياس سرعة الشبكة</p>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <span>اختصارات لوحة المفاتيح</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="accordion-content">
                            <p><strong>Ctrl + S:</strong> بدء المسح المتقدم</p>
                            <p><strong>Ctrl + R:</strong> تحديث الشبكات</p>
                            <p><strong>Ctrl + E:</strong> تصدير البيانات</p>
                            <p><strong>Ctrl + M:</strong> بدء المراقبة المباشرة</p>
                            <p><strong>Ctrl + F:</strong> إضافة إلى المفضلة</p>
                        </div>
                    </div>
                </div>
            `;
            
            showModal('دليل استخدام Network Scanner Pro', tutorialContent, 'حسناً');
        }

        // Toggle accordion item
        function toggleAccordion(header) {
            const item = header.parentElement;
            const isActive = item.classList.contains('active');
            
            // Close all accordion items
            document.querySelectorAll('.accordion-item').forEach(el => {
                el.classList.remove('active');
                el.querySelector('.accordion-header i').className = 'fas fa-chevron-down';
            });
            
            // Open clicked item if it wasn't active
            if (!isActive) {
                item.classList.add('active');
                header.querySelector('i').className = 'fas fa-chevron-up';
            }
        }

        // Switch between tabs
        function switchTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Deactivate all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Activate selected tab
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`).classList.add('active');
            
            appState.activeTab = tabId;
        }

        // Render signal strength bars
        function renderSignalBars(strength) {
            const bars = Math.ceil(strength / 25);
            let html = '<div class="signal-bars">';
            for (let i = 1; i <= 4; i++) {
                html += `<div class="bar ${i <= bars ? 'active' : ''}"></div>`;
            }
            html += '</div>';
            return `<div class="signal-strength">${strength}% ${html}</div>`;
        }

        // Render networks table
        function renderNetworks() {
            const tbody = document.getElementById('networksTable');
            tbody.innerHTML = '';

            let networksToShow = advancedNetworks;
            
            // Apply filters
            if (appState.currentFilter !== 'all') {
                networksToShow = advancedNetworks.filter(network => {
                    switch (appState.currentFilter) {
                        case 'secure': return network.security !== 'open';
                        case 'open': return network.security === 'open';
                        case 'hidden': return network.hidden;
                        case 'strong': return network.signal >= 70;
                        case 'mobile': return network.type.includes('mobile');
                        case 'wpa3': return network.security === 'wpa3';
                        case 'enterprise': return network.authentication.includes('Enterprise');
                        default: return true;
                    }
                });
            }

            networksToShow.forEach(network => {
                const row = document.createElement('tr');
                row.className = 'network-row';
                row.setAttribute('data-network-id', network.id);
                
                const typeLabels = {
                    'wifi': 'WiFi',
                    'mobile-5g': '5G',
                    'mobile-4g': '4G',
                    'mobile-3g': '3G'
                };

                const securityLabels = {
                    'wpa3': 'WPA3',
                    'wpa2': 'WPA2',
                    'wep': 'WEP',
                    'open': 'مفتوح'
                };

                row.innerHTML = `
                    <td title="${network.ssid}">${network.ssid.length > 15 ? network.ssid.substring(0, 15) + '...' : network.ssid}</td>
                    <td><span class="network-type ${network.type}">${typeLabels[network.type]}</span></td>
                    <td><span class="security-badge ${network.security}">${securityLabels[network.security]}</span></td>
                    <td>${renderSignalBars(network.signal)}</td>
                    <td>${network.channel}</td>
                    <td><i class="fas fa-users"></i> ${network.clients}</td>
                    <td>
                        <span class="status-indicator ${network.hidden ? 'hidden' : 'visible'}"></span>
                        ${network.hidden ? 'مخفية' : 'مرئية'}
                    </td>
                    <td>${network.lastActivity}</td>
                `;

                // Add click event to select network
                row.addEventListener('click', () => selectNetwork(network));
                tbody.appendChild(row);
            });
        }

        // Render favorites table
        function renderFavorites() {
            const tbody = document.getElementById('favoritesTable');
            tbody.innerHTML = '';
            
            const favoriteNetworks = advancedNetworks.filter(network => 
                appState.favorites.includes(network.id)
            );
            
            favoriteNetworks.forEach(network => {
                const row = document.createElement('tr');
                row.className = 'network-row';
                row.setAttribute('data-network-id', network.id);
                
                const typeLabels = {
                    'wifi': 'WiFi',
                    'mobile-5g': '5G',
                    'mobile-4g': '4G',
                    'mobile-3g': '3G'
                };

                const securityLabels = {
                    'wpa3': 'WPA3',
                    'wpa2': 'WPA2',
                    'wep': 'WEP',
                    'open': 'مفتوح'
                };

                row.innerHTML = `
                    <td title="${network.ssid}">${network.ssid.length > 15 ? network.ssid.substring(0, 15) + '...' : network.ssid}</td>
                    <td><span class="network-type ${network.type}">${typeLabels[network.type]}</span></td>
                    <td><span class="security-badge ${network.security}">${securityLabels[network.security]}</span></td>
                    <td>${renderSignalBars(network.signal)}</td>
                    <td>${network.channel}</td>
                    <td><i class="fas fa-users"></i> ${network.clients}</td>
                    <td>
                        <span class="status-indicator ${network.hidden ? 'hidden' : 'visible'}"></span>
                        ${network.hidden ? 'مخفية' : 'مرئية'}
                    </td>
                    <td>${network.lastActivity}</td>
                `;

                // Add click event to select network
                row.addEventListener('click', () => selectNetwork(network));
                tbody.appendChild(row);
            });
        }

        // Render history table
        function renderHistory() {
            const tbody = document.getElementById('historyTable');
            tbody.innerHTML = '';
            
            // Combine history from all networks
            const allHistory = [];
            advancedNetworks.forEach(network => {
                network.history.forEach(entry => {
                    allHistory.push({
                        networkId: network.id,
                        ssid: network.ssid,
                        date: entry.date,
                        duration: "1 يوم", // Simplified for demo
                        signal: entry.signal,
                        clients: entry.clients,
                        status: network.hidden ? 'مخفية' : 'مرئية'
                    });
                });
            });
            
            // Sort by date (newest first)
            allHistory.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Display history
            allHistory.forEach(entry => {
                const network = advancedNetworks.find(n => n.id === entry.networkId);
                if (!network) return;
                
                const row = document.createElement('tr');
                row.className = 'network-row';
                row.setAttribute('data-network-id', network.id);
                
                row.innerHTML = `
                    <td title="${entry.ssid}">${entry.ssid.length > 15 ? entry.ssid.substring(0, 15) + '...' : entry.ssid}</td>
                    <td>${entry.date}</td>
                    <td>${entry.duration}</td>
                    <td>${renderSignalBars(entry.signal)}</td>
                    <td><i class="fas fa-users"></i> ${entry.clients}</td>
                    <td>
                        <span class="status-indicator ${network.hidden ? 'hidden' : 'visible'}"></span>
                        ${entry.status}
                    </td>
                `;

                // Add click event to select network
                row.addEventListener('click', () => {
                    const network = advancedNetworks.find(n => n.id === entry.networkId);
                    if (network) selectNetwork(network);
                });
                tbody.appendChild(row);
            });
        }

        // Select a network for detailed analysis
        function selectNetwork(network) {
            appState.selectedNetwork = network;
            
            // Update visual selection
            document.querySelectorAll('.network-row').forEach(row => {
                row.classList.remove('selected');
            });
            document.querySelector(`[data-network-id="${network.id}"]`).classList.add('selected');
            
            // Hide no selection message
            document.getElementById('noSelection').style.display = 'none';
            
            // Show and populate network details
            const detailsDiv = document.getElementById('networkDetails');
            detailsDiv.innerHTML = generateNetworkDetails(network);
            detailsDiv.classList.add('show');
            
            // Initialize charts
            setTimeout(() => {
                initializeCharts(network);
                initializeMap(network);
            }, 100);
            
            // Add to history
            addToHistory(network.id);
        }

        // Add network to history
        function addToHistory(networkId) {
            const network = advancedNetworks.find(n => n.id === networkId);
            if (!network) return;
            
            const historyEntry = {
                networkId: network.id,
                ssid: network.ssid,
                date: new Date().toISOString().split('T')[0],
                signal: network.signal,
                clients: network.clients,
                status: network.hidden ? 'مخفية' : 'مرئية'
            };
            
            // Check if this network is already in history today
            const existingIndex = appState.history.findIndex(entry => 
                entry.networkId === networkId && entry.date === historyEntry.date
            );
            
            if (existingIndex >= 0) {
                appState.history[existingIndex] = historyEntry;
            } else {
                appState.history.unshift(historyEntry);
            }
            
            // Keep only the last 50 entries
            if (appState.history.length > 50) {
                appState.history.pop();
            }
            
            saveState();
            renderHistory();
        }

        // Add network to favorites
        function addToFavorites(networkId = null) {
            if (!networkId) networkId = appState.contextMenuNetwork;
            if (!networkId) return;
            
            if (appState.favorites.includes(networkId)) {
                // Remove from favorites
                appState.favorites = appState.favorites.filter(id => id !== networkId);
                showNotification('تمت الإزالة', 'تمت إزالة الشبكة من المفضلة');
            } else {
                // Add to favorites
                appState.favorites.push(networkId);
                showNotification('تمت الإضافة', 'تمت إضافة الشبكة إلى المفضلة');
            }
            
            saveState();
            renderFavorites();
            
            // Update the selected network if it's the one being favorited
            if (appState.selectedNetwork && appState.selectedNetwork.id === networkId) {
                selectNetwork(appState.selectedNetwork);
            }
        }

        // Generate detailed network information
        function generateNetworkDetails(network) {
            const securityScoreClass = 
                network.securityScore >= 90 ? 'score-excellent' :
                network.securityScore >= 70 ? 'score-good' :
                network.securityScore >= 50 ? 'score-poor' : 'score-critical';

            const securityScoreText = 
                network.securityScore >= 90 ? 'ممتاز' :
                network.securityScore >= 70 ? 'جيد' :
                network.securityScore >= 50 ? 'ضعيف' : 'خطير';

            const isFavorite = appState.favorites.includes(network.id);

            return `
                <div class="detail-header pulse">
                    <div class="detail-ssid">${network.ssid}</div>
                    <div class="detail-type">${network.vendor} - ${network.type.toUpperCase()}</div>
                    <button class="btn btn-sm ${isFavorite ? 'btn-warning' : 'btn-outline'}" onclick="addToFavorites(${network.id})" style="position: absolute; left: 2rem; top: 2rem;">
                        <i class="fas fa-star"></i>
                        ${isFavorite ? 'مفضلة' : 'إضافة إلى المفضلة'}
                    </button>
                </div>

                <div class="security-score ${securityScoreClass}">
                    <div class="score-number">${network.securityScore}</div>
                    <div class="score-label">نقاط الأمان - ${securityScoreText}</div>
                </div>

                <div class="detail-section">
                    <h3><i class="fas fa-info-circle"></i> المعلومات الأساسية</h3>
                    <div class="detail-item">
                        <span class="detail-label">SSID:</span>
                        <span class="detail-value">${network.ssid}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">BSSID:</span>
                        <span class="detail-value"><code>${network.bssid}</code></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">MAC Address:</span>
                        <span class="detail-value"><code>${network.mac}</code></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">الشركة المصنعة:</span>
                        <span class="detail-value">${network.vendor}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">نظام التشغيل:</span>
                        <span class="detail-value">${network.operatingSystem}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">إصدار البرنامج:</span>
                        <span class="detail-value">${network.firmwareVersion}</span>
                    </div>
                </div>

                <div class="detail-section">
                    <h3><i class="fas fa-wifi"></i> تفاصيل الاتصال</h3>
                    <div class="detail-item">
                        <span class="detail-label">التردد:</span>
                        <span class="detail-value">${network.frequency}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">القناة:</span>
                        <span class="detail-value">${network.channel}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">عرض النطاق:</span>
                        <span class="detail-value">${network.bandwidth}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">معدل البيانات:</span>
                        <span class="detail-value">${network.dataRate}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">قوة الإشارة:</span>
                        <span class="detail-value">${network.signal}%</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">المعايير المدعومة:</span>
                        <span class="detail-value">${network.supportedStandards.join(', ')}</span>
                    </div>
                </div>

                <div class="detail-section">
                    <h3><i class="fas fa-shield-alt"></i> الأمان والتشفير</h3>
                    <div class="detail-item">
                        <span class="detail-label">نوع التشفير:</span>
                        <span class="detail-value">${network.encryption}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">المصادقة:</span>
                        <span class="detail-value">${network.authentication}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">الثغرات الأمنية:</span>
                        <span class="detail-value">
                            ${network.vulnerabilities.length === 0 ? 
                                '<span style="color: var(--success-color);">لا توجد ثغرات معروفة</span>' : 
                                `<span style="color: var(--warning-color);">${network.vulnerabilities.join(', ')}</span>`
                            }
                        </span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">الإمكانيات:</span>
                        <span class="detail-value">${network.capabilities.join(', ')}</span>
                    </div>
                </div>

                <div class="detail-section">
                    <h3><i class="fas fa-chart-line"></i> إحصائيات الشبكة</h3>
                    <div class="monitoring-grid">
                        <div class="monitor-item">
                            <div class="monitor-value">${network.clients}</div>
                            <div class="monitor-label">متصلين</div>
                        </div>
                        <div class="monitor-item">
                            <div class="monitor-value">${network.traffic}</div>
                            <div class="monitor-label">حركة البيانات</div>
                        </div>
                        <div class="monitor-item">
                            <div class="monitor-value">${network.uptime}</div>
                            <div class="monitor-label">وقت التشغيل</div>
                        </div>
                        <div class="monitor-item">
                            <div class="monitor-value">${network.beaconInterval}ms</div>
                            <div class="monitor-label">Beacon Interval</div>
                        </div>
                    </div>
                </div>

                <div class="detail-section">
                    <h3><i class="fas fa-chart-bar"></i> مراقبة مباشرة</h3>
                    <div class="chart-container">
                        <canvas id="signalChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="clientsChart"></canvas>
                    </div>
                </div>

                <div class="detail-section">
                    <h3><i class="fas fa-map-marker-alt"></i> الموقع الجغرافي</h3>
                    <div class="map-container" id="networkMap"></div>
                    <div class="detail-item" style="margin-top: 1rem;">
                        <span class="detail-label">خط العرض:</span>
                        <span class="detail-value">${network.geolocation.lat}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">خط الطول:</span>
                        <span class="detail-value">${network.geolocation.lng}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">آخر نشاط:</span>
                        <span class="detail-value">${network.lastActivity}</span>
                    </div>
                </div>

                <div class="detail-section">
                    <h3><i class="fas fa-tools"></i> أدوات متقدمة</h3>
                    <div class="tools-section">
                        <button class="tool-btn" onclick="performPingSweep('${network.id}')">
                            <i class="fas fa-satellite-dish"></i>
                            Ping Sweep
                        </button>
                        <button class="tool-btn" onclick="portScan('${network.id}')">
                            <i class="fas fa-search"></i>
                            Port Scan
                        </button>
                        <button class="tool-btn" onclick="packetCapture('${network.id}')">
                            <i class="fas fa-download"></i>
                            Packet Capture
                        </button>
                        <button class="tool-btn" onclick="speedTest('${network.id}')">
                            <i class="fas fa-tachometer-alt"></i>
                            Speed Test
                        </button>
                        <button class="tool-btn" onclick="geolocate('${network.id}')">
                            <i class="fas fa-map-marker-alt"></i>
                            تحديد الموقع
                        </button>
                        <button class="tool-btn" onclick="vulnerabilityScan('${network.id}')">
                            <i class="fas fa-bug"></i>
                            فحص الثغرات
                        </button>
                        <button class="tool-btn" onclick="wifiAnalyzer()">
                            <i class="fas fa-chart-pie"></i>
                            محلل WiFi
                        </button>
                        <button class="tool-btn" onclick="deauthAttackTest()">
                            <i class="fas fa-user-lock"></i>
                            اختبار Deauth
                        </button>
                    </div>
                </div>
            `;
        }

        // Initialize charts for network monitoring
        function initializeCharts(network) {
            // Destroy existing charts
            if (appState.signalChart) appState.signalChart.destroy();
            if (appState.clientsChart) appState.clientsChart.destroy();

            // Signal strength chart
            const signalCtx = document.getElementById('signalChart');
            if (signalCtx) {
                appState.signalChart = new Chart(signalCtx, {
                    type: 'line',
                    data: {
                        labels: ['10 دقائق', '8 دقائق', '6 دقائق', '4 دقائق', '2 دقائق', 'الآن'],
                        datasets: [{
                            label: 'قوة الإشارة (%)',
                            data: [network.signal - 10, network.signal - 5, network.signal + 2, network.signal - 3, network.signal + 1, network.signal],
                            borderColor: 'var(--primary-color)',
                            backgroundColor: 'rgba(0, 255, 255, 0.1)',
                            tension: 0.4,
                            fill: true,
                            borderWidth: 2,
                            pointBackgroundColor: 'var(--primary-color)',
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { 
                                labels: { 
                                    color: 'var(--text-color)',
                                    font: {
                                        size: 12
                                    }
                                }
                            }
                        },
                        scales: {
                            y: { 
                                min: 0,
                                max: 100,
                                ticks: { 
                                    color: 'var(--text-color)',
                                    stepSize: 20
                                },
                                grid: { 
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            x: { 
                                ticks: { 
                                    color: 'var(--text-color)'
                                },
                                grid: { 
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                });
            }

            // Clients chart
            const clientsCtx = document.getElementById('clientsChart');
            if (clientsCtx) {
                appState.clientsChart = new Chart(clientsCtx, {
                    type: 'bar',
                    data: {
                        labels: ['10 دقائق', '8 دقائق', '6 دقائق', '4 دقائق', '2 دقائق', 'الآن'],
                        datasets: [{
                            label: 'عدد المتصلين',
                            data: [network.clients - 3, network.clients - 1, network.clients + 2, network.clients - 1, network.clients + 1, network.clients],
                            backgroundColor: 'rgba(255, 0, 255, 0.6)',
                            borderColor: 'var(--secondary-color)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { 
                                labels: { 
                                    color: 'var(--text-color)',
                                    font: {
                                        size: 12
                                    }
                                }
                            }
                        },
                        scales: {
                            y: { 
                                beginAtZero: true,
                                ticks: { 
                                    color: 'var(--text-color)',
                                    stepSize: 5
                                },
                                grid: { 
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            x: { 
                                ticks: { 
                                    color: 'var(--text-color)'
                                },
                                grid: { 
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                });
            }
        }

        // Initialize network map
        function initializeMap(network) {
            const mapContainer = document.getElementById('networkMap');
            if (!mapContainer) return;
            
            mapContainer.innerHTML = ''; // Clear previous map
            
            const map = L.map(mapContainer).setView([network.geolocation.lat, network.geolocation.lng], 15);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            L.marker([network.geolocation.lat, network.geolocation.lng])
                .addTo(map)
                .bindPopup(`<b>${network.ssid}</b><br>${network.vendor}`)
                .openPopup();
                
            // Add circle to show approximate location accuracy
            L.circle([network.geolocation.lat, network.geolocation.lng], {
                color: 'var(--primary-color)',
                fillColor: 'var(--primary-color)',
                fillOpacity: 0.2,
                radius: 50
            }).addTo(map);
        }

        // Initialize network activity chart
        function initializeNetworkActivityChart() {
            const ctx = document.getElementById('networkActivityChart');
            if (!ctx) return;
            
            // Generate sample data for the last 24 hours
            const labels = [];
            const data = [];
            
            for (let i = 0; i < 24; i++) {
                labels.push(`${i}:00`);
                data.push(Math.floor(Math.random() * 100));
            }
            
            appState.networkActivityChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'نشاط الشبكة',
                        data: data,
                        borderColor: 'var(--primary-color)',
                        backgroundColor: 'rgba(0, 255, 255, 0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            labels: { 
                                color: 'var(--text-color)'
                            }
                        }
                    },
                    scales: {
                        y: { 
                            ticks: { 
                                color: 'var(--text-color)'
                            },
                            grid: { 
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: { 
                            ticks: { 
                                color: 'var(--text-color)'
                            },
                            grid: { 
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        // Change time range for network activity chart
        function changeTimeRange(range) {
            if (!appState.networkActivityChart) return;
            
            let labels = [];
            let data = [];
            
            if (range === '1h') {
                // Last hour in 5-minute intervals
                for (let i = 0; i < 12; i++) {
                    labels.push(`${i*5} دقيقة`);
                    data.push(Math.floor(Math.random() * 100));
                }
            } else if (range === '6h') {
                // Last 6 hours in 30-minute intervals
                for (let i = 0; i < 12; i++) {
                    labels.push(`${i*0.5} ساعة`);
                    data.push(Math.floor(Math.random() * 100));
                }
            } else {
                // Last 24 hours in 1-hour intervals
                for (let i = 0; i < 24; i++) {
                    labels.push(`${i}:00`);
                    data.push(Math.floor(Math.random() * 100));
                }
            }
            
            appState.networkActivityChart.data.labels = labels;
            appState.networkActivityChart.data.datasets[0].data = data;
            appState.networkActivityChart.update();
        }

        // Update monitoring data
        function updateMonitoringData() {
            // Generate random monitoring data
            appState.monitoringData = {
                totalTraffic: (Math.random() * 100).toFixed(1) + ' GB',
                packetLoss: (Math.random() * 5).toFixed(1) + '%',
                connectedDevices: Math.floor(Math.random() * 50),
                networkLatency: Math.floor(Math.random() * 100) + 'ms',
                securityAlerts: Math.floor(Math.random() * 10),
                signalQuality: Math.floor(Math.random() * 100) + '%',
                activityData: Array(24).fill().map(() => Math.floor(Math.random() * 100))
            };
            
            // Update UI
            document.getElementById('totalTraffic').textContent = appState.monitoringData.totalTraffic;
            document.getElementById('packetLoss').textContent = appState.monitoringData.packetLoss;
            document.getElementById('connectedDevices').textContent = appState.monitoringData.connectedDevices;
            document.getElementById('networkLatency').textContent = appState.monitoringData.networkLatency;
            document.getElementById('securityAlerts').textContent = appState.monitoringData.securityAlerts;
            document.getElementById('signalQuality').textContent = appState.monitoringData.signalQuality;
            
            // Update chart if exists
            if (appState.networkActivityChart) {
                appState.networkActivityChart.data.datasets[0].data = appState.monitoringData.activityData;
                appState.networkActivityChart.update();
            }
            
            // Schedule next update
            if (appState.isMonitoring) {
                setTimeout(updateMonitoringData, 5000);
            }
        }

        // Update statistics
        function updateStatistics() {
            const stats = {
                total: advancedNetworks.length,
                secure: advancedNetworks.filter(n => n.security !== 'open').length,
                open: advancedNetworks.filter(n => n.security === 'open').length,
                hidden: advancedNetworks.filter(n => n.hidden).length,
                strong: advancedNetworks.filter(n => n.signal >= 70).length,
                mobile: advancedNetworks.filter(n => n.type.includes('mobile')).length,
                wpa3: advancedNetworks.filter(n => n.security === 'wpa3').length,
                enterprise: advancedNetworks.filter(n => n.authentication.includes('Enterprise')).length
            };

            document.getElementById('totalNetworks').textContent = stats.total;
            document.getElementById('secureNetworks').textContent = stats.secure;
            document.getElementById('openNetworks').textContent = stats.open;
            document.getElementById('hiddenNetworks').textContent = stats.hidden;
            document.getElementById('strongSignals').textContent = stats.strong;
            document.getElementById('mobileNetworks').textContent = stats.mobile;
            document.getElementById('wpa3Networks').textContent = stats.wpa3;
            document.getElementById('enterpriseNetworks').textContent = stats.enterprise;
        }

        // Filter networks
        function filterNetworks(filter) {
            appState.currentFilter = filter;
            renderNetworks();
            
            // Update active state on stat cards
            document.querySelectorAll('.stat-card').forEach(card => {
                card.classList.remove('pulse');
            });
            event.target.closest('.stat-card').classList.add('pulse');
        }

        // Button functions
        function startAdvancedScan() {
            if (appState.isScanning) return;
            
            appState.isScanning = true;
            const loadingDiv = document.getElementById('loading');
            loadingDiv.style.display = 'block';
            
            // Simulate scan progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress > 100) progress = 100;
                document.getElementById('scanProgress').style.width = `${progress}%`;
                
                if (progress === 100) {
                    clearInterval(progressInterval);
                    loadingDiv.style.display = 'none';
                    
                    // Simulate new networks discovery
                    advancedNetworks.forEach(network => {
                        network.signal = Math.max(20, Math.min(100, network.signal + (Math.random() - 0.5) * 10));
                        network.clients = Math.max(0, network.clients + Math.floor((Math.random() - 0.5) * 3));
                        network.lastActivity = Math.random() > 0.5 ? 'الآن' : 'منذ دقيقة';
                    });
                    
                    renderNetworks();
                    updateStatistics();
                    
                    // Auto-refresh every 15 seconds
                    appState.scanInterval = setInterval(() => {
                        advancedNetworks.forEach(network => {
                            network.signal = Math.max(20, Math.min(100, network.signal + (Math.random() - 0.5) * 5));
                            network.clients = Math.max(0, network.clients + Math.floor((Math.random() - 0.5) * 2));
                        });
                        renderNetworks();
                        updateStatistics();
                        
                        // Update selected network details if any
                        if (appState.selectedNetwork) {
                            const updatedNetwork = advancedNetworks.find(n => n.id === appState.selectedNetwork.id);
                            if (updatedNetwork) {
                                selectNetwork(updatedNetwork);
                            }
                        }
                    }, 15000);
                    
                    showNotification('تم المسح بنجاح', `تم اكتشاف ${advancedNetworks.length} شبكة`, 3000);
                }
            }, 300);
        }

        function stopScan() {
            appState.isScanning = false;
            if (appState.scanInterval) {
                clearInterval(appState.scanInterval);
            }
            document.getElementById('loading').style.display = 'none';
            showNotification('تم الإيقاف', 'تم إيقاف عملية المسح', 3000);
        }

        function startRealTimeMonitoring() {
            if (appState.isMonitoring) return;
            
            appState.isMonitoring = true;
            updateMonitoringData();
            showNotification('بدء المراقبة', 'تم بدء المراقبة المباشرة للشبكات', 3000);
        }

        function stopRealTimeMonitoring() {
            appState.isMonitoring = false;
            showNotification('إيقاف المراقبة', 'تم إيقاف المراقبة المباشرة', 3000);
        }

        function performSecurityAudit() {
            if (!appState.selectedNetwork) {
                showNotification('تحذير', 'يرجى اختيار شبكة أولاً لإجراء التدقيق الأمني!', 3000);
                return;
            }
            
            const network = appState.selectedNetwork;
            const vulnerabilities = network.vulnerabilities.length === 0 ? 
                'لا توجد ثغرات أمنية خطيرة' : 
                `تم اكتشاف الثغرات التالية:\n${network.vulnerabilities.map(v => `- ${v}`).join('\n')}`;
            
            const auditResults = `
                <div class="detail-section">
                    <h3><i class="fas fa-shield-alt"></i> نتائج التدقيق الأمني</h3>
                    <div class="detail-item">
                        <span class="detail-label">اسم الشبكة:</span>
                        <span class="detail-value">${network.ssid}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">نقاط الأمان:</span>
                        <span class="detail-value">${network.securityScore}/100</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">نوع التشفير:</span>
                        <span class="detail-value">${network.encryption}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">الثغرات الأمنية:</span>
                        <span class="detail-value">${vulnerabilities}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">التوصيات:</span>
                        <span class="detail-value">
                            ${network.securityScore >= 90 ? 'الشبكة آمنة جداً ولا تحتاج إلى إجراءات إضافية' :
                              network.securityScore >= 70 ? 'يفضل تحديث كلمة المرور وتعطيل WPS إذا لم يكن ضرورياً' :
                              network.securityScore >= 50 ? 'يجب تغيير كلمة المرور وتحديث البرامج الثابتة للموجه' :
                              'الشبكة غير آمنة ويجب اتخاذ إجراءات فورية لتأمينها'}
                        </span>
                    </div>
                </div>
            `;
            
            showModal('نتائج التدقيق الأمني', auditResults, 'حسناً');
        }

        function refreshNetworks() {
            startAdvancedScan();
        }

        function exportAdvancedData() {
            const exportData = {
                timestamp: new Date().toISOString(),
                totalNetworks: advancedNetworks.length,
                selectedNetwork: appState.selectedNetwork,
                networks: advancedNetworks,
                statistics: {
                    secure: advancedNetworks.filter(n => n.security !== 'open').length,
                    open: advancedNetworks.filter(n => n.security === 'open').length,
                    hidden: advancedNetworks.filter(n => n.hidden).length,
                    mobile: advancedNetworks.filter(n => n.type.includes('mobile')).length
                }
            };
            
            const data = JSON.stringify(exportData, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `advanced_network_scan_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('تم التصدير', 'تم تصدير البيانات المتقدمة بنجاح', 3000);
        }

        function showAdvancedSettings() {
            const settingsContent = `
                <div class="detail-section">
                    <h3><i class="fas fa-cog"></i> الإعدادات المتقدمة</h3>
                    <div class="detail-item">
                        <span class="detail-label">مدة المسح:</span>
                        <select class="detail-value" style="background: var(--dark-bg); color: var(--text-color); border: 1px solid var(--primary-color); padding: 0.3rem; border-radius: 5px;">
                            <option>10 ثواني</option>
                            <option selected>30 ثانية</option>
                            <option>1 دقيقة</option>
                            <option>5 دقائق</option>
                        </select>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">عمق المسح:</span>
                        <select class="detail-value" style="background: var(--dark-bg); color: var(--text-color); border: 1px solid var(--primary-color); padding: 0.3rem; border-radius: 5px;">
                            <option>سريع</option>
                            <option selected>عادي</option>
                            <option>شامل</option>
                            <option>متعمق</option>
                        </select>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">تحديث تلقائي:</span>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">إشعارات الأمان:</span>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">تنسيق التصدير:</span>
                        <select class="detail-value" style="background: var(--dark-bg); color: var(--text-color); border: 1px solid var(--primary-color); padding: 0.3rem; border-radius: 5px;">
                            <option>JSON</option>
                            <option>CSV</option>
                            <option>XML</option>
                            <option selected>PDF</option>
                        </select>
                    </div>
                </div>
                <div class="detail-section">
                    <h3><i class="fas fa-palette"></i> إعدادات الواجهة</h3>
                    <div class="detail-item">
                        <span class="detail-label">الوضع الليلي:</span>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">لون السمة:</span>
                        <div style="display: flex; gap: 0.5rem;">
                            <div style="width: 20px; height: 20px; background: var(--primary-color); border-radius: 50%; border: 2px solid white; cursor: pointer;"></div>
                            <div style="width: 20px; height: 20px; background: #00ff88; border-radius: 50%; border: 2px solid white; cursor: pointer;"></div>
                            <div style="width: 20px; height: 20px; background: #ff00ff; border-radius: 50%; border: 2px solid white; cursor: pointer;"></div>
                            <div style="width: 20px; height: 20px; background: #ffaa00; border-radius: 50%; border: 2px solid white; cursor: pointer;"></div>
                        </div>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">حجم الخط:</span>
                        <select class="detail-value" style="background: var(--dark-bg); color: var(--text-color); border: 1px solid var(--primary-color); padding: 0.3rem; border-radius: 5px;">
                            <option>صغير</option>
                            <option selected>متوسط</option>
                            <option>كبير</option>
                        </select>
                    </div>
                </div>
            `;
            
            showModal('الإعدادات المتقدمة', settingsContent, 'حفظ التغييرات', function() {
                showNotification('تم الحفظ', 'تم حفظ الإعدادات بنجاح', 3000);
            });
        }

        function showReports() {
            const reportsContent = `
                <div class="detail-section">
                    <h3><i class="fas fa-file-alt"></i> تقارير مخصصة</h3>
                    <div class="tools-section">
                        <button class="tool-btn" onclick="generateSecurityReport()">
                            <i class="fas fa-shield-alt"></i>
                            تقرير الأمان
                        </button>
                        <button class="tool-btn" onclick="generatePerformanceReport()">
                            <i class="fas fa-tachometer-alt"></i>
                            تقرير الأداء
                        </button>
                        <button class="tool-btn" onclick="generateTrafficReport()">
                            <i class="fas fa-traffic-light"></i>
                            تقرير الحركة
                        </button>
                        <button class="tool-btn" onclick="generateFullReport()">
                            <i class="fas fa-file-pdf"></i>
                            تقرير كامل
                        </button>
                    </div>
                </div>
                <div class="detail-section">
                    <h3><i class="fas fa-cog"></i> خيارات التقرير</h3>
                    <div class="detail-item">
                        <span class="detail-label">نطاق التاريخ:</span>
                        <select class="detail-value" style="background: var(--dark-bg); color: var(--text-color); border: 1px solid var(--primary-color); padding: 0.3rem; border-radius: 5px;">
                            <option>آخر 24 ساعة</option>
                            <option selected>آخر أسبوع</option>
                            <option>آخر شهر</option>
                            <option>مخصص</option>
                        </select>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">تنسيق التقرير:</span>
                        <select class="detail-value" style="background: var(--dark-bg); color: var(--text-color); border: 1px solid var(--primary-color); padding: 0.3rem; border-radius: 5px;">
                            <option>PDF</option>
                            <option selected>HTML</option>
                            <option>CSV</option>
                            <option>JSON</option>
                        </select>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">إدراج الرسوم البيانية:</span>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">إدراج التوصيات:</span>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                </div>
            `;
            
            showModal('التقارير المخصصة', reportsContent, 'إنشاء التقرير', function() {
                showNotification('تم الإنشاء', 'جاري إنشاء التقرير المطلوب', 3000);
                setTimeout(() => {
                    showNotification('تم الإنشاء', 'تم إنشاء التقرير بنجاح', 3000);
                }, 2000);
            });
        }

        // Advanced tool functions
        function performPingSweep(networkId) {
            if (!networkId) {
                showNotification('تحذير', 'يرجى اختيار شبكة أولاً', 3000);
                return;
            }
            
            const network = advancedNetworks.find(n => n.id == networkId);
            const activeDevices = Math.floor(Math.random() * 10) + network.clients;
            const avgResponse = Math.floor(Math.random() * 50 + 10);
            const packetLoss = Math.floor(Math.random() * 5);
            
            const results = `
                <div class="detail-section">
                    <h3><i class="fas fa-satellite-dish"></i> نتائج Ping Sweep</h3>
                    <div class="detail-item">
                        <span class="detail-label">الشبكة:</span>
                        <span class="detail-value">${network.ssid}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">الأجهزة النشطة:</span>
                        <span class="detail-value">${activeDevices}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">متوسط وقت الاستجابة:</span>
                        <span class="detail-value">${avgResponse}ms</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">معدل فقدان الحزم:</span>
                        <span class="detail-value">${packetLoss}%</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">نطاق IP:</span>
                        <span class="detail-value">192.168.1.1 - 192.168.1.${activeDevices}</span>
                    </div>
                </div>
                <div class="detail-section">
                    <h3><i class="fas fa-list"></i> الأجهزة المكتشفة</h3>
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${Array(activeDevices).fill().map((_, i) => `
                            <div class="detail-item">
                                <span class="detail-label">192.168.1.${i+1}:</span>
                                <span class="detail-value">${['Router', 'Phone', 'Laptop', 'Tablet', 'Smart TV', 'IoT Device'][Math.floor(Math.random() * 6)]}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            showModal('نتائج Ping Sweep', results, 'حسناً');
        }

        function portScan(networkId) {
            if (!networkId) {
                showNotification('تحذير', 'يرجى اختيار شبكة أولاً', 3000);
                return;
            }
            
            const network = advancedNetworks.find(n => n.id == networkId);
            const openPorts = ['22', '80', '443', '8080'].slice(0, Math.floor(Math.random() * 4) + 1);
            const portServices = {
                '22': 'SSH',
                '80': 'HTTP',
                '443': 'HTTPS',
                '8080': 'HTTP-Alt'
            };
            
            const results = `
                <div class="detail-section">
                    <h3><i class="fas fa-search"></i> نتائج Port Scan</h3>
                    <div class="detail-item">
                        <span class="detail-label">الشبكة:</span>
                        <span class="detail-value">${network.ssid}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">العنوان المستهدف:</span>
                        <span class="detail-value">192.168.1.1</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">المنافذ المفتوحة:</span>
                        <span class="detail-value">${openPorts.length}</span>
                    </div>
                </div>
                <div class="detail-section">
                    <h3><i class="fas fa-list"></i> تفاصيل المنافذ</h3>
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${openPorts.map(port => `
                            <div class="detail-item">
                                <span class="detail-label">Port ${port}:</span>
                                <span class="detail-value">${portServices[port]} - ${['Open', 'Filtered', 'Unfiltered'][Math.floor(Math.random() * 3)]}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                <div class="detail-section">
                    <h3><i class="fas fa-exclamation-triangle"></i> تحذير أمني</h3>
                    <p>يجب إغلاق أي منافذ غير ضرورية لتقليل سطح الهجوم. المنافذ المفتوحة قد تعرض الشبكة لخطر الاختراق.</p>
                </div>
            `;
            
            showModal('نتائج Port Scan', results, 'حسناً');
        }

        function packetCapture(networkId) {
            if (!networkId) {
                showNotification('تحذير', 'يرجى اختيار شبكة أولاً', 3000);
                return;
            }
            
            const network = advancedNetworks.find(n => n.id == networkId);
            const packetRate = Math.floor(Math.random() * 1000 + 100);
            const dataSize = (Math.random() * 10 + 1).toFixed(2);
            const protocols = ['HTTP', 'HTTPS', 'TCP', 'UDP', 'DNS', 'ARP'];
            const numProtocols = Math.floor(Math.random() * 4) + 2;
            const detectedProtocols = [];
            
            for (let i = 0; i < numProtocols; i++) {
                const randomIndex = Math.floor(Math.random() * protocols.length);
                if (!detectedProtocols.includes(protocols[randomIndex])) {
                    detectedProtocols.push(protocols[randomIndex]);
                }
            }
            
            const results = `
                <div class="detail-section">
                    <h3><i class="fas fa-download"></i> نتائج Packet Capture</h3>
                    <div class="detail-item">
                        <span class="detail-label">الشبكة:</span>
                        <span class="detail-value">${network.ssid}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">معدل الحزم:</span>
                        <span class="detail-value">${packetRate} packet/sec</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">حجم البيانات:</span>
                        <span class="detail-value">${dataSize} MB/min</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">البروتوكولات المكتشفة:</span>
                        <span class="detail-value">${detectedProtocols.join(', ')}</span>
                    </div>
                </div>
                <div class="detail-section">
                    <h3><i class="fas fa-exclamation-triangle"></i> تحذير أمني</h3>
                    <p>يجب تشفير جميع البيانات الحساسة باستخدام بروتوكولات آمنة مثل HTTPS وSSH. تجنب إرسال بيانات حساسة عبر بروتوكولات غير مشفرة مثل HTTP.</p>
                </div>
            `;
            
            showModal('نتائج Packet Capture', results, 'حسناً');
        }

        function speedTest(networkId) {
            if (!networkId) {
                showNotification('تحذير', 'يرجى اختيار شبكة أولاً', 3000);
                return;
            }
            
            const network = advancedNetworks.find(n => n.id == networkId);
            const downloadSpeed = Math.floor(Math.random() * 100 + 50);
            const uploadSpeed = Math.floor(downloadSpeed * 0.8);
            const ping = Math.floor(Math.random() * 30 + 10);
            const quality = downloadSpeed > 80 ? 'ممتازة' : downloadSpeed > 50 ? 'جيدة' : 'متوسطة';
            
            const results = `
                <div class="detail-section">
                    <h3><i class="fas fa-tachometer-alt"></i> نتائج اختبار السرعة</h3>
                    <div class="detail-item">
                        <span class="detail-label">الشبكة:</span>
                        <span class="detail-value">${network.ssid}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">سرعة التنزيل:</span>
                        <span class="detail-value">${downloadSpeed} Mbps</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">سرعة الرفع:</span>
                        <span class="detail-value">${uploadSpeed} Mbps</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">زمن الاستجابة:</span>
                        <span class="detail-value">${ping}ms</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">جودة الاتصال:</span>
                        <span class="detail-value">${quality}</span>
                    </div>
                </div>
                <div class="chart-container" style="height: 150px;">
                    <canvas id="speedTestChart"></canvas>
                </div>
            `;
            
            showModal('نتائج اختبار السرعة', results, 'حسناً', function() {
                // Initialize speed test chart
                const ctx = document.getElementById('speedTestChart');
                if (ctx) {
                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['تنزيل', 'رفع', 'زمن الاستجابة'],
                            datasets: [{
                                label: 'النتائج',
                                data: [downloadSpeed, uploadSpeed, ping],
                                backgroundColor: [
                                    'rgba(0, 255, 255, 0.6)',
                                    'rgba(255, 0, 255, 0.6)',
                                    'rgba(255, 170, 0, 0.6)'
                                ],
                                borderColor: [
                                    'var(--primary-color)',
                                    'var(--secondary-color)',
                                    'var(--warning-color)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false }
                            },
                            scales: {
                                y: { 
                                    beginAtZero: true,
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                },
                                x: { 
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                }
                            }
                        }
                    });
                }
            });
        }

        function geolocate(networkId) {
            if (!networkId) {
                showNotification('تحذير', 'يرجى اختيار شبكة أولاً', 3000);
                return;
            }
            
            const network = advancedNetworks.find(n => n.id == networkId);
            
            const results = `
                <div class="detail-section">
                    <h3><i class="fas fa-map-marker-alt"></i> نتائج تحديد الموقع</h3>
                    <div class="detail-item">
                        <span class="detail-label">الشبكة:</span>
                        <span class="detail-value">${network.ssid}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">خط العرض:</span>
                        <span class="detail-value">${network.geolocation.lat}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">خط الطول:</span>
                        <span class="detail-value">${network.geolocation.lng}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">المنطقة المقدرة:</span>
                        <span class="detail-value">القاهرة، مصر</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">دقة التحديد:</span>
                        <span class="detail-value">±50 متر</span>
                    </div>
                </div>
                <div class="map-container" style="height: 300px;" id="geolocationMap"></div>
                <div class="detail-section">
                    <h3><i class="fas fa-exclamation-triangle"></i> ملاحظة قانونية</h3>
                    <p>هذه البيانات تقديرية وللأغراض التعليمية فقط. يمنع استخدام هذه الأداة لتحديد مواقع الشبكات دون إذن مسبق.</p>
                </div>
            `;
            
            showModal('نتائج تحديد الموقع', results, 'حسناً', function() {
                // Initialize map
                const mapContainer = document.getElementById('geolocationMap');
                if (mapContainer) {
                    const map = L.map(mapContainer).setView([network.geolocation.lat, network.geolocation.lng], 16);
                    
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                    }).addTo(map);
                    
                    L.marker([network.geolocation.lat, network.geolocation.lng])
                        .addTo(map)
                        .bindPopup(`<b>${network.ssid}</b><br>${network.vendor}`)
                        .openPopup();
                        
                    // Add circle to show approximate location accuracy
                    L.circle([network.geolocation.lat, network.geolocation.lng], {
                        color: 'var(--primary-color)',
                        fillColor: 'var(--primary-color)',
                        fillOpacity: 0.2,
                        radius: 50
                    }).addTo(map);
                }
            });
        }

        function vulnerabilityScan(networkId) {
            if (!networkId) {
                showNotification('تحذير', 'يرجى اختيار شبكة أولاً', 3000);
                return;
            }
            
            const network = advancedNetworks.find(n => n.id == networkId);
            const scanResults = network.vulnerabilities.length === 0 ? 
                'لم يتم اكتشاف أي ثغرات أمنية خطيرة!' : 
                `تم اكتشاف الثغرات التالية:\n${network.vulnerabilities.map(vuln => `- ${vuln}`).join('\n')}`;
                
            const recommendations = `
                <div class="detail-section">
                    <h3><i class="fas fa-lightbulb"></i> توصيات الأمان</h3>
                    <ul style="padding-right: 1.5rem;">
                        <li>استخدام WPA3 إذا كان متاحاً</li>
                        <li>تحديث كلمة المرور بانتظام</li>
                        <li>تعطيل WPS إذا لم يكن ضرورياً</li>
                        <li>تحديث البرامج الثابتة للموجه</li>
                        <li>تعطيل الإدارة عن بعد</li>
                        <li>تفعيل جدار الحماية</li>
                    </ul>
                </div>
            `;
            
            showModal('نتائج فحص الثغرات', `
                <div class="detail-section">
                    <h3><i class="fas fa-bug"></i> نتائج الفحص</h3>
                    <div class="detail-item">
                        <span class="detail-label">الشبكة:</span>
                        <span class="detail-value">${network.ssid}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">نقاط الأمان:</span>
                        <span class="detail-value">${network.securityScore}/100</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">الثغرات المكتشفة:</span>
                        <span class="detail-value">
                            ${network.vulnerabilities.length === 0 ? 
                                '<span style="color: var(--success-color);">لا توجد ثغرات خطيرة</span>' : 
                                `<span style="color: var(--warning-color);">${network.vulnerabilities.join(', ')}</span>`
                            }
                        </span>
                    </div>
                </div>
                ${network.vulnerabilities.length > 0 ? recommendations : ''}
            `, 'حسناً');
        }

        function wifiAnalyzer() {
            if (!appState.selectedNetwork) {
                showNotification('تحذير', 'يرجى اختيار شبكة أولاً', 3000);
                return;
            }
            
            const channels = {
                '2.4GHz': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13],
                '5GHz': [36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 116, 120, 124, 128, 132, 136, 140, 144, 149, 153, 157, 161, 165]
            };
            
            // Generate random channel utilization data
            const channelData24 = channels['2.4GHz'].map(ch => Math.floor(Math.random() * 100));
            const channelData5 = channels['5GHz'].map(ch => Math.floor(Math.random() * 100));
            
            const results = `
                <div class="detail-section">
                    <h3><i class="fas fa-chart-pie"></i> محلل WiFi</h3>
                    <div class="detail-item">
                        <span class="detail-label">النطاق الترددي:</span>
                        <span class="detail-value">2.4GHz و 5GHz</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">القنوات المزدحمة:</span>
                        <span class="detail-value">6 (2.4GHz), 36 (5GHz)</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">القنوات الموصى بها:</span>
                        <span class="detail-value">1 أو 11 (2.4GHz), 149 أو 157 (5GHz)</span>
                    </div>
                </div>
                <div class="chart-container" style="height: 200px;">
                    <canvas id="wifi24Chart"></canvas>
                </div>
                <div class="chart-container" style="height: 200px;">
                    <canvas id="wifi5Chart"></canvas>
                </div>
                <div class="detail-section">
                    <h3><i class="fas fa-lightbulb"></i> التوصيات</h3>
                    <ul style="padding-right: 1.5rem;">
                        <li>استخدم قناة 1 أو 11 في نطاق 2.4GHz لتجنب التداخل</li>
                        <li>استخدم نطاق 5GHz للأجهزة التي تدعمه لتحقيق أداء أفضل</li>
                        <li>تجنب القنوات المزدحمة لتحسين جودة الإشارة</li>
                        <li>اضبط الموجه على القناة الأقل ازدحاماً تلقائياً إذا كانت الميزة متاحة</li>
                    </ul>
                </div>
            `;
            
            showModal('نتائج محلل WiFi', results, 'حسناً', function() {
                // Initialize 2.4GHz chart
                const ctx24 = document.getElementById('wifi24Chart');
                if (ctx24) {
                    new Chart(ctx24, {
                        type: 'bar',
                        data: {
                            labels: channels['2.4GHz'],
                            datasets: [{
                                label: 'استخدام القناة (%)',
                                data: channelData24,
                                backgroundColor: 'rgba(0, 255, 255, 0.6)',
                                borderColor: 'var(--primary-color)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { 
                                    labels: { 
                                        color: 'var(--text-color)'
                                    }
                                }
                            },
                            scales: {
                                y: { 
                                    max: 100,
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                },
                                x: { 
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                }
                            }
                        }
                    });
                }
                
                // Initialize 5GHz chart
                const ctx5 = document.getElementById('wifi5Chart');
                if (ctx5) {
                    new Chart(ctx5, {
                        type: 'bar',
                        data: {
                            labels: channels['5GHz'],
                            datasets: [{
                                label: 'استخدام القناة (%)',
                                data: channelData5,
                                backgroundColor: 'rgba(255, 0, 255, 0.6)',
                                borderColor: 'var(--secondary-color)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { 
                                    labels: { 
                                        color: 'var(--text-color)'
                                    }
                                }
                            },
                            scales: {
                                y: { 
                                    max: 100,
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                },
                                x: { 
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                }
                            }
                        }
                    });
                }
            });
        }

        function deauthAttackTest() {
            if (!appState.selectedNetwork) {
                showNotification('تحذير', 'يرجى اختيار شبكة أولاً', 3000);
                return;
            }
            
            const network = advancedNetworks.find(n => n.id == appState.selectedNetwork.id);
            const isProtected = network.security !== 'open';
            const resistanceLevel = isProtected ? 
                (network.security === 'wpa3' ? 'عالية جداً' : 
                 network.security === 'wpa2' ? 'متوسطة' : 'ضعيفة') : 
                'غير محمية';
            
            const results = `
                <div class="detail-section">
                    <h3><i class="fas fa-user-lock"></i> نتائج اختبار Deauth</h3>
                    <div class="detail-item">
                        <span class="detail-label">الشبكة:</span>
                        <span class="detail-value">${network.ssid}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">نوع التشفير:</span>
                        <span class="detail-value">${network.security.toUpperCase()}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">مقاومة هجمات Deauth:</span>
                        <span class="detail-value" style="color: ${resistanceLevel === 'عالية جداً' ? 'var(--success-color)' : 
                                                               resistanceLevel === 'متوسطة' ? 'var(--warning-color)' : 
                                                               'var(--danger-color)'}">
                            ${resistanceLevel}
                        </span>
                    </div>
                </div>
                <div class="detail-section">
                    <h3><i class="fas fa-exclamation-triangle"></i> تحذير أمني</h3>
                    <p>هجمات Deauth يمكن أن تسبب انقطاع الاتصال بالأجهزة المتصلة بالشبكة. الشبكات المفتوحة أو التي تستخدم تشفير WEP/WPA معرضة بشكل خاص لهذه الهجمات.</p>
                </div>
                <div class="detail-section">
                    <h3><i class="fas fa-lightbulb"></i> توصيات الحماية</h3>
                    <ul style="padding-right: 1.5rem;">
                        <li>استخدم WPA3 لتوفير أفضل حماية ضد هجمات Deauth</li>
                        <li>قم بتحديث برامج الموجه بانتظام</li>
                        <li>تفعيل حماية إدارة الإطار (802.11w) إذا كان مدعوماً</li>
                        <li>مراقبة الشبكة لاكتشاف أي هجمات مشبوهة</li>
                    </ul>
                </div>
            `;
            
            showModal('نتائج اختبار Deauth', results, 'حسناً');
        }

        function exportNetworkData() {
            if (!appState.contextMenuNetwork) return;
            
            const network = advancedNetworks.find(n => n.id == appState.contextMenuNetwork);
            if (!network) return;
            
            const data = JSON.stringify(network, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `network_${network.ssid}_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('تم التصدير', `تم تصدير بيانات الشبكة ${network.ssid}`, 3000);
            hideContextMenu();
        }

        function showNetworkHistory() {
            if (!appState.contextMenuNetwork) return;
            
            const network = advancedNetworks.find(n => n.id == appState.contextMenuNetwork);
            if (!network) return;
            
            const historyContent = `
                <div class="detail-section">
                    <h3><i class="fas fa-history"></i> سجل الشبكة</h3>
                    <div class="detail-item">
                        <span class="detail-label">SSID:</span>
                        <span class="detail-value">${network.ssid}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">BSSID:</span>
                        <span class="detail-value">${network.bssid}</span>
                    </div>
                </div>
                <div class="detail-section">
                    <h3><i class="fas fa-list"></i> السجل الزمني</h3>
                    <div style="max-height: 300px; overflow-y: auto;">
                        ${network.history.map(entry => `
                            <div class="detail-item">
                                <span class="detail-label">${entry.date}:</span>
                                <span class="detail-value">إشارة: ${entry.signal}% | متصلين: ${entry.clients}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                <div class="chart-container" style="height: 200px;">
                    <canvas id="networkHistoryChart"></canvas>
                </div>
            `;
            
            showModal(`سجل الشبكة ${network.ssid}`, historyContent, 'حسناً', function() {
                // Initialize history chart
                const ctx = document.getElementById('networkHistoryChart');
                if (ctx) {
                    const labels = network.history.map(entry => entry.date).reverse();
                    const signalData = network.history.map(entry => entry.signal).reverse();
                    const clientsData = network.history.map(entry => entry.clients).reverse();
                    
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'قوة الإشارة (%)',
                                    data: signalData,
                                    borderColor: 'var(--primary-color)',
                                    backgroundColor: 'rgba(0, 255, 255, 0.1)',
                                    tension: 0.4,
                                    yAxisID: 'y'
                                },
                                {
                                    label: 'عدد المتصلين',
                                    data: clientsData,
                                    borderColor: 'var(--secondary-color)',
                                    backgroundColor: 'rgba(255, 0, 255, 0.1)',
                                    tension: 0.4,
                                    yAxisID: 'y1'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { 
                                    labels: { 
                                        color: 'var(--text-color)'
                                    }
                                }
                            },
                            scales: {
                                y: { 
                                    type: 'linear',
                                    display: true,
                                    position: 'left',
                                    title: {
                                        display: true,
                                        text: 'قوة الإشارة (%)',
                                        color: 'var(--primary-color)'
                                    },
                                    min: 0,
                                    max: 100,
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                },
                                y1: {
                                    type: 'linear',
                                    display: true,
                                    position: 'right',
                                    title: {
                                        display: true,
                                        text: 'عدد المتصلين',
                                        color: 'var(--secondary-color)'
                                    },
                                    min: 0,
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { drawOnChartArea: false }
                                },
                                x: { 
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                }
                            }
                        }
                    });
                }
            });
            
            hideContextMenu();
        }

        function compareNetworks() {
            if (!appState.contextMenuNetwork) return;
            
            const network1 = advancedNetworks.find(n => n.id == appState.contextMenuNetwork);
            if (!network1) return;
            
            // Select another network to compare
            const otherNetworks = advancedNetworks.filter(n => n.id !== appState.contextMenuNetwork);
            if (otherNetworks.length === 0) return;
            
            const network2 = otherNetworks[Math.floor(Math.random() * otherNetworks.length)];
            
            const comparisonContent = `
                <div class="detail-section">
                    <h3><i class="fas fa-exchange-alt"></i> مقارنة الشبكات</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div>
                            <h4 style="color: var(--primary-color); text-align: center;">${network1.ssid}</h4>
                            <div class="detail-item">
                                <span class="detail-label">نوع التشفير:</span>
                                <span class="detail-value">${network1.security.toUpperCase()}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">قوة الإشارة:</span>
                                <span class="detail-value">${network1.signal}%</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">عدد المتصلين:</span>
                                <span class="detail-value">${network1.clients}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">نقاط الأمان:</span>
                                <span class="detail-value">${network1.securityScore}/100</span>
                            </div>
                        </div>
                        <div>
                            <h4 style="color: var(--secondary-color); text-align: center;">${network2.ssid}</h4>
                            <div class="detail-item">
                                <span class="detail-label">نوع التشفير:</span>
                                <span class="detail-value">${network2.security.toUpperCase()}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">قوة الإشارة:</span>
                                <span class="detail-value">${network2.signal}%</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">عدد المتصلين:</span>
                                <span class="detail-value">${network2.clients}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">نقاط الأمان:</span>
                                <span class="detail-value">${network2.securityScore}/100</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="chart-container" style="height: 250px;">
                    <canvas id="comparisonChart"></canvas>
                </div>
            `;
            
            showModal('مقارنة الشبكات', comparisonContent, 'حسناً', function() {
                // Initialize comparison chart
                const ctx = document.getElementById('comparisonChart');
                if (ctx) {
                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['نوع التشفير', 'قوة الإشارة', 'عدد المتصلين', 'نقاط الأمان'],
                            datasets: [
                                {
                                    label: network1.ssid,
                                    data: [
                                        network1.security === 'wpa3' ? 100 : 
                                        network1.security === 'wpa2' ? 75 : 
                                        network1.security === 'wep' ? 50 : 25,
                                        network1.signal,
                                        network1.clients,
                                        network1.securityScore
                                    ],
                                    backgroundColor: 'rgba(0, 255, 255, 0.6)',
                                    borderColor: 'var(--primary-color)',
                                    borderWidth: 1
                                },
                                {
                                    label: network2.ssid,
                                    data: [
                                        network2.security === 'wpa3' ? 100 : 
                                        network2.security === 'wpa2' ? 75 : 
                                        network2.security === 'wep' ? 50 : 25,
                                        network2.signal,
                                        network2.clients,
                                        network2.securityScore
                                    ],
                                    backgroundColor: 'rgba(255, 0, 255, 0.6)',
                                    borderColor: 'var(--secondary-color)',
                                    borderWidth: 1
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { 
                                    labels: { 
                                        color: 'var(--text-color)'
                                    }
                                }
                            },
                            scales: {
                                y: { 
                                    beginAtZero: true,
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                },
                                x: { 
                                    ticks: { color: 'var(--text-color)' },
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                                }
                            }
                        }
                    });
                }
            });
            
            hideContextMenu();
        }

        function hideNetwork() {
            if (!appState.contextMenuNetwork) return;
            
            const network = advancedNetworks.find(n => n.id == appState.contextMenuNetwork);
            if (!network) return;
            
            network.hidden = true;
            renderNetworks();
            renderFavorites();
            
            if (appState.selectedNetwork && appState.selectedNetwork.id === network.id) {
                document.getElementById('noSelection').style.display = 'block';
                document.getElementById('networkDetails').classList.remove('show');
            }
            
            showNotification('تم الإخفاء', `تم إخفاء الشبكة ${network.ssid} من القائمة`, 3000);
            hideContextMenu();
        }

        // Initialize application when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>